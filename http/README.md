# 什么是HTTP
协议是指计算机通信网络中两台计算机之间进行通信所必须共同遵守的规定或规则，超文本传输协议(HTTP)是一种通信协议，它允许将超文本标记语言(HTML)文档从Web服务器传送到客户端的浏览器<br/>
## http在使用场景中的流程：
1. http客户端发起请求，创建端口；<br/>
2. http服务器在端口监听客户端请求；<br/>
3. http服务器想客户返回状态和内容。<br/>

这个网址可以查看DNS：[chrome://net-internals/#dns](chrome://net-internals/#dns)，可以浏览曾经浏览过的网站的缓存记录

## 流程：
1. 首先,是对imooc.com域名解析<br/>
  1.1 浏览器搜索浏览器自身的DNS缓存。查找：chrome://net-internals/#dns<br/>
  1.2 如果浏览器没有找到自身的DNS缓存或之前的缓存已失效，那么浏览器会搜索操作系统自身的DNS缓存。<br/>
  1.3 如果操作系统的DNS缓存也没有找到，那么系统会尝试在本地的HOST文件去找。<br/>
  1.4 如果在HOST里依然没有找到，浏览器会发起一个DNS的系统调用，即一般向本地的宽带运营商发起域名解析请求。这后面又可以试情况分很多步骤，第一，宽带运营商服务器会首先查看自身的缓存，看是否有结果，如果没有，那么运营商服务器会发起一个迭代DNS解析请求（即一步一步寻找：根域，顶级域，域名注册商），最终会返回对DNS解析的结果。运营商服务器然后把结果返回给操作系统内核（同时也缓存在自己的缓存区），然后操作系统把结果返回给浏览器。<br/>
  1.5 以上的最终结果，是让浏览器拿到imooc.com的IP地址，DNS解析完成。<br/>
2. 然后,在浏览器获得域名的IP地址后，发起“三次握手”，建立TCP/IP连接。
3. 在TCP/IP连接建立起来后，浏览器就可以向服务器发送HTTP请求了。比如，用HTTP的GET方法请求一个根域里的某个域名，协议可以采用HTTP 1.0 。
4. 服务器端接受这个请求，根据路径参数，经过后端的一些处理之后，把处理后的一个结果以数据的形式返回给浏览器，如果是imooc.com网站的页面，服务器就会把完整的HTML页面代码返回给浏览器。
5. 浏览器拿到了imooc.com这个网站的完整HTML页面代码，在解析和渲染这个页面的时候，里面的Javascript、CSS、图片等静态资源，它们同样也是一个个HTTP请求，都需要经过上面的步骤来获取。
6. 浏览器根据拿到的资源对页面进行渲染，最终把一个完整的页面呈现出来。
注：可以将HTTP的流程拆分为请求和响应两部分，这两部分都会发送http头和正文信息；http头发送的是一些附加的信息：内容类型、服务器发送响应的日期、http状态码；正文信息：用户提交的表单数据。

## 以node的官网为例
http://web.jobbole.com/89106/<br/>
打开控制台，查看netWord。<br/>
### 查看network：
network工具功能强大，能够让我看到网页加载的信息，比如加载时间，和先后顺序，是否是并行加载，还是堵塞加载。<br/>
#### 打开时，默认情况下有八列:<br/>
1. Name:表示加载的文件名。
2. Method:表示请求的方式。
3. Status:表示状态码（200为请求成功，304表示从缓存读取）。
4. Type:表示文件的MIME Type的类型。
5. Initiator:表示发出这个文件请求的发出者。
6. Size:表示文件大小。
7. Time:表示每个请求的总时长。
8. Timeline:以图表的形式显示元素的请求和加载情况。<br/>

#### 将鼠标移到timeline的横向柱条，会弹出一个详情页,不同颜色的横向柱条表示不同的含义:   
1. Stalled：浏览器得到要发出这个请求的指令，到请求可以发出的等待时间，一般是代理协商、以及等待可复用的TCP连接释放的时间，不包括DNS查询、建立TCP连接等时间等。
2. Request sent：请求第一个字节发出前到最后一个字节发出后的时间，也就是上传时间。
3. Waiting 请求发出后，到收到响应的第一个字节所花费的时间(Time To First Byte)。
4. Content Download 收到响应的第一个字节，到接受完最后一个字节的时间，就是下载时间。<br/>

在上面还有个过滤器Filter的选项，这个选项下面也有很多选项，可以对资源进行筛选。<br/>
对name下的文件点击之后会出现相应的详细信息。<br/>
在详细信息中也有各种选项：headers、preview、response、cookies、timing。<br/>

#### Timing各部分的含义.Timing 图形化显示请求资源 耗费的时间
1. stalled，等待时间，就是浏览器要发出这个请求到可以发出这个请求的时间
2. request sent：请求时间，就是请求的第一个字节发出以前到最后一个字节发出后的时间
3. waiting：请求发出后到收到响应的第一个字节耗费的时间
4. content download：内容下载时间。收到响应的第一个字节开始到接受最后一个字节所耗费的时间<br/>
详情可参考：http://www.cnblogs.com/ys-ys/p/5625409.html<br/>

#### 请求方法：八种，以不同的方式来操作指定的资源。
get:请求资源；post:提交资源；put:更新；delete:删除；head:类似get ；trace ；options<br/>
http://www.cnblogs.com/yin-jingyu/archive/2011/08/01/2123548.html

#### 状态码
第一位表示类别：<br/>
  1xx  表示请求已经接收，进行进一步的处理<br/>
  2xx  请求已经成功的接收并处理<br/>
  3xx  请求重定向，需要另外的一些处理<br/>
  4xx  客户端错误，请求的有语法错误或者请求无法实现<br/>
  5xx  服务器端错误<br/>
控制台上的response header后面有view sourse ：可以查看原始的情况，而不是格式化之后的。<br/>

## HTTP 事件回调进阶
http相关的内容在node中的http模块都能够获取到，它提供了许多接口。<br/>
HTTP模块：支持更多特性、不缓冲请求和响应、处理流相关。<br/>
### 接下来提供一下几个问题：
1. 什么是回调？<br/>
回调是异步编程时的基础，将后续逻辑封装成起始函数的参数，逐层嵌套<br/>
http目录下的实例callback.js。
2. 什么是同步/异步？ 示例async.js<br/>
同步是指：发送方发出数据后，等接收方发回响应以后才发下一个数据包的通讯方式。  <br/>
异步是指：发送方发出数据后，不等接收方发回响应，接着发送下个数据包的通讯方式。  <br/>
3. 什么是I/O？<br/>
磁盘的写入（in）磁盘的读取（out）<br/>
4. 什么的单线程/多线程？<br/>
一次只能执行一个程序叫做单线程<br/>
一次能执行多个程序叫多线程<br/>
5. 什么是阻塞/非阻塞？<br/>
阻塞：前一个程序未执行完就得一直等待<br/>
非阻塞：前一个程序未执行完时可以挂起，继续执行其他程序，等到使用时再执行。<br/>
所以呢，对于单线程的node.js来讲，可以通过回调的方式来进行异步编程，可以达到非阻塞的效果。那么回调函数什么时候被调用呢，这时就要用到事件了。<br/>
6. 什么是事件？<br/>
一个触发动作（例如点击按钮）<br/>
7. 什么是事件驱动？<br/>
一个触发动作引起的操作（例如点击按钮后弹出一个对话框）<br/>
8. 什么是基于事件驱动的回调？<br/>
为了某个事件注册了回调函数，但是这个回调函数不是马上执行，只有当事件发生的时候，才会调用回调函数，这种函数执行的方式叫做事件驱动~这种注册回调就是基于事件驱动的回调，如果这些回调和异步I/O(数据写入、读取)操作有关，可以看作是基于回调的异步I/O，只不过这种回调在nodejs中是有事件来驱动的
9. 什么是事件循环？<br/>
//事件循环Eventloop,倘若有大量的异步操作，一些I/O的耗时操作，甚至是一些定时器控制的延时操作，它们完成的时候都要调用相应的回调函数，从而来完成一些密集的任务，而又不会阻塞整个程序执行的流程，此时需要一种机制来管理，这种机制叫做事件循环.
总而言之就是：管理大量异步操作的机制叫做事件循环<br/>
Event Loop:<br/>
回调函数队列。异步执行的函数会被压入这个队列; 队列被循环查询。<br/>

## http模块源码：
阅读代码要有一定的轮廓思路，先给自己设置好问题，针对不同功能模块去阅读。<br/>
在github可以查案master，看node的更新历程。这里可以选择所要的版本。<br/>
在github打开node查看代码，找到自己想要的分支：在主页按大写的T就能呼出页面的搜索功能，然后检索http.js<br/>
可以按Ctrl+f进行搜索。<br/>
加了下划线的模块就是私有模块，通过exports就可以暴漏出去。<br/>
先看createServer，可以看到它是server的一个实例，由const server = require('_http_server');可以看出与_http_server有关。再按大写的T就能呼出的页面搜索_http_server。<br/>
。。。。。。<br/>
https://cnodejs.org/topic/5725a25f3f27a7c841bcb82e<br/>

## HTTP 性能测试
Apache ab<br/>
http://jingyan.baidu.com/article/e3c78d647a57833c4c85f502.html<br/>
测试的话跟设备的配置也是有关系的。<br/>
